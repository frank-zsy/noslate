"use strict";(self.webpackChunknoslate_website=self.webpackChunknoslate_website||[]).push([[8385],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>f});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(r),f=a,h=p["".concat(l,".").concat(f)]||p[f]||d[f]||o;return r?n.createElement(h,i(i({ref:t},u),{},{components:r})):n.createElement(h,i({ref:t},u))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},5688:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=r(7462),a=(r(7294),r(3905));const o={},i="Flexible Strategy",s={unversionedId:"noslate_workers/references/scale",id:"noslate_workers/references/scale",title:"Flexible Strategy",description:"The overall design concept of Noslated is that Worker instances are pulled up based on traffic, quickly expanded, and slowly reduced.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/noslate_workers/references/scale.md",sourceDirName:"noslate_workers/references",slug:"/noslate_workers/references/scale",permalink:"/en/docs/noslate_workers/references/scale",draft:!1,editUrl:"https://github.com/noslate-project/noslate/tree/main/site/docs/noslate_workers/references/scale.md",tags:[],version:"current",frontMatter:{},sidebar:"common",previous:{title:"Environment Variable",permalink:"/en/docs/noslate_workers/references/envionment_variables"},next:{title:"Noslated SDK",permalink:"/en/docs/noslate_workers/references/sdk"}},l={},c=[{value:"1. basic strategy",id:"1-basic-strategy",level:2},{value:"2. Disposable Mode",id:"2-disposable-mode",level:2},{value:"3. Reservation Strategy",id:"3-reservation-strategy",level:2},{value:"4. Shrink Strategy",id:"4-shrink-strategy",level:2}],u={toc:c};function d(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"flexible-strategy"},"Flexible Strategy"),(0,a.kt)("p",null,"The overall design concept of Noslated is that Worker instances are pulled up based on traffic, quickly expanded, and slowly reduced."),(0,a.kt)("h2",{id:"1-basic-strategy"},"1. basic strategy"),(0,a.kt)("p",null,"After the traffic enters the Data Plane, if there is no Worker instance that can process the request, it will notify the Control Plane through the ",(0,a.kt)("strong",{parentName:"p"},"requestQueueing")," event, and it will decide the amount of expansion based on the current water level. If the Worker instance cannot be created, it will return the resource limit. report an error. After the new Worker instance is started, it will automatically connect to Data Plane. After Data Plane finds that the new Worker instance is connected, it will actively trigger an initialization request. After the initialization is successful, it will start to consume the accumulated requests in the request queue."),(0,a.kt)("p",null,"When the Worker instance is idle for a period of time, Control Plane will actively initiate a GC operation to tell Data Plane to close the traffic. After the traffic is closed, Control Plane will notify Turf to close the Worker instance and clean up the remaining resources."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"\u57fa\u672c\u6d41\u7a0b",src:r(8332).Z,width:"1207",height:"1020"})),(0,a.kt)("h2",{id:"2-disposable-mode"},"2. Disposable Mode"),(0,a.kt)("p",null,"For specific flexible scenarios, such as user script execution, in order to isolate the context between different requests, a Worker instance can be created for each request and destroyed after execution."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'// Worker instance configuration\n{\n    "worker": {\n        "disposable": true\n    }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"\u5373\u629b\u6a21\u5f0f",src:r(1077).Z,width:"1207",height:"1020"})),(0,a.kt)("p",null,"The startup time of Node.js Worker instances is generally long. You can use the Aworker runtime with ",(0,a.kt)("a",{parentName:"p",href:"/en/docs/noslate_workers/aworker/intro#warmfork"},"Warmfork")," and ",(0,a.kt)("a",{parentName:"p",href:"/en/docs/noslate_workers/aworker/intro#startup-snapshot"},"Startup Snapshot")," capability to complete Worker instance startup faster."),(0,a.kt)("h2",{id:"3-reservation-strategy"},"3. Reservation Strategy"),(0,a.kt)("p",null,"Some Worker instances take a long time to start. In order to respond to requests in a timely manner, the minimum number of worker instances is configured, that is, the reserved configuration. When the traffic arrives, it will directly filter the available Worker instances and distribute the traffic. If the traffic level is too high, the capacity expansion operation will be performed according to the strategy in (1), and the capacity will be scaled down when idle, but the scaling result will not be less than the value configured by the minimum number of instances."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'// Worker instance configuration\n{\n    "worker": {\n        "reservationCount": 1\n    }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"\u9884\u7559\u7b56\u7565",src:r(4094).Z,width:"1207",height:"1020"})),(0,a.kt)("h2",{id:"4-shrink-strategy"},"4. Shrink Strategy"),(0,a.kt)("p",null,"The default scaling strategy is to select the Worker instance with the current minimum concurrency, that is, the most idle Worker instance. However, two other strategies are also supported, FIFO (create first, destroy first) and FILO (create first and then destroy), which can be set in the Worker instance configuration."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"type ShrinkStrategy = 'FILO' | 'FIFO' | 'LCC';\n// Worker instance configuration\n{\n    \"worker\": {\n        \"shrinkStrategy\": \"LCC\"\n    }\n}\n")))}d.isMDXComponent=!0},1077:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/noslated_disposable_mode-f70f85c456005ba924712aee90f395a3.png"},8332:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/noslated_normal_scale-f413a4d6f46376643d1cc02e5c14fb61.png"},4094:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/noslated_reserved_scale-1b659b33ec2b4fc9a665192d390bf869.png"}}]);