"use strict";(self.webpackChunknoslate_website=self.webpackChunknoslate_website||[]).push([[9687],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),u=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},d=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),c=u(r),m=a,k=c["".concat(i,".").concat(m)]||c[m]||s[m]||l;return r?n.createElement(k,o(o({ref:t},d),{},{components:r})):n.createElement(k,o({ref:t},d))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,o=new Array(l);o[0]=c;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p.mdxType="string"==typeof e?e:a,o[1]=p;for(var u=2;u<l;u++)o[u]=r[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},5218:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>s,frontMatter:()=>l,metadata:()=>p,toc:()=>u});var n=r(7462),a=(r(7294),r(3905));const l={},o="Noslate Debugger \u4ecb\u7ecd",p={unversionedId:"debugger/intro",id:"debugger/intro",title:"Noslate Debugger \u4ecb\u7ecd",description:"Noslate Debugger",source:"@site/docs/debugger/intro.md",sourceDirName:"debugger",slug:"/debugger/intro",permalink:"/docs/debugger/intro",draft:!1,editUrl:"https://github.com/noslate-project/noslate/tree/main/site/docs/debugger/intro.md",tags:[],version:"current",frontMatter:{},sidebar:"debugger",next:{title:"Andb",permalink:"/docs/debugger/andb/intro"}},i={},u=[{value:"\u4ec0\u4e48\u662f Noslate Debugger",id:"\u4ec0\u4e48\u662f-noslate-debugger",level:2},{value:"\u4f7f\u7528\u7b80\u5355",id:"\u4f7f\u7528\u7b80\u5355",level:3},{value:"\u9002\u5e94 Serverless",id:"\u9002\u5e94-serverless",level:2},{value:"\u57fa\u4e8e Corefile \u7684 &quot;\u5feb\u7167&quot;",id:"\u57fa\u4e8e-corefile-\u7684-\u5feb\u7167",level:3},{value:"\u66f4\u5c0f\u7684\u4e1a\u52a1\u5f71\u54cd",id:"\u66f4\u5c0f\u7684\u4e1a\u52a1\u5f71\u54cd",level:3},{value:"\u8c03\u8bd5\u4fe1\u606f\u5e93",id:"\u8c03\u8bd5\u4fe1\u606f\u5e93",level:2}],d={toc:u};function s(e){let{components:t,...l}=e;return(0,a.kt)("wrapper",(0,n.Z)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"noslate-debugger-\u4ecb\u7ecd"},"Noslate Debugger \u4ecb\u7ecd"),(0,a.kt)("div",{style:{maxWidth:"800px"}},(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Noslate Debugger",src:r(8617).Z,width:"1270",height:"339"}))),(0,a.kt)("h2",{id:"\u4ec0\u4e48\u662f-noslate-debugger"},"\u4ec0\u4e48\u662f Noslate Debugger"),(0,a.kt)("p",null,"Noslate Debugger \u662f\u9488\u5bf9 V8 \u5e94\u7528\u7684\u79bb\u7ebf\u5206\u6790\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u5206\u6790 Node.js \u7b49\u5e94\u7528\u7a0b\u5e8f\u4ea7\u751f\u7684 Corefile (Core \u6587\u4ef6)\uff0c"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u68c0\u67e5 Node.js/V8 \u5e94\u7528\u7a0b\u5e8f\u7684\u7ed3\u6784\u4f53\u3001\u5806\u6808\u7b49\u5185\u5bb9"),(0,a.kt)("li",{parentName:"ul"},"\u68c0\u67e5 V8 \u5806\u5185\u7684\u5404\u79cd\u5bf9\u8c61\u4fe1\u606f"),(0,a.kt)("li",{parentName:"ul"},"\u4ece Corefile \u4e2d\u5bfc\u51fa Heap Snapshot"),(0,a.kt)("li",{parentName:"ul"},"\u4e1a\u52a1\u65e0\u611f\u83b7\u53d6 Corefile (\u901a\u8fc7 Arthur \u5de5\u5177)"),(0,a.kt)("li",{parentName:"ul"},"\u5df2\u652f\u6301 Node.js / Alinode / AWorker LTS \u5b98\u65b9\u53d1\u884c\u7248")),(0,a.kt)("h3",{id:"\u4f7f\u7528\u7b80\u5355"},"\u4f7f\u7528\u7b80\u5355"),(0,a.kt)("p",null,"\u53ea\u9700\u8981\u4e00\u6761\u547d\u4ee4\uff0c\u5c31\u53ef\u4ee5\u5728 MacOS / Linux / Windows (\u901a\u8fc7 WSL) \u4e0a\u5206\u6790 Corefile\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"andb -l -c core.123\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("inlineCode",{parentName:"p"},"andb")," \u662f Noslate Deubber \u5957\u4ef6\u4e2d\u7684\u79bb\u7ebf\u5206\u6790\u5de5\u5177\uff0c\u57fa\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"gdb"),"/",(0,a.kt)("inlineCode",{parentName:"p"},"lldb")," \u63d2\u4ef6\u4f53\u7cfb\u4e8c\u6b21\u5f00\u53d1\u3002")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"andb")," \u4f1a\u81ea\u52a8\u4e0b\u8f7d Core \u4ea7\u751f\u65f6\u5339\u914d\u7684 Node.js \u7248\u672c\u5e76\u5f00\u59cb\u8c03\u8bd5\uff0c\u53ef\u4ee5\u9009\u62e9\u4f60\u6240\u719f\u6089\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"gdb")," \u6216 ",(0,a.kt)("inlineCode",{parentName:"p"},"lldb")," \u5de5\u5177\u5f00\u59cb\u8c03\u8bd5."),(0,a.kt)("video",{controls:!0},(0,a.kt)("source",{src:"/demo_andb.mp4"})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6f14\u793a\u52a0\u8f7d Corefile \u53ca\u81ea\u52a8\u5316\u5339\u914d\u7248\u672c\u53ca\u8c03\u8bd5\u4fe1\u606f"),(0,a.kt)("li",{parentName:"ul"},"\u6f14\u793a Isolate \u7ed3\u6784\u4f53\u7684\u5b9a\u4f4d\u548c\u6253\u5370"),(0,a.kt)("li",{parentName:"ul"},"\u6f14\u793a V8 Heap Space \u548c Page \u4fe1\u606f"),(0,a.kt)("li",{parentName:"ul"},"\u6f14\u793a V8 Heap Summary \u6458\u8981 \u548c Inspect \u5bf9\u8c61"),(0,a.kt)("li",{parentName:"ul"},"\u6f14\u793a Heap Snapshot \u5bfc\u51fa")),(0,a.kt)("h2",{id:"\u9002\u5e94-serverless"},"\u9002\u5e94 Serverless"),(0,a.kt)("p",null,"\u957f\u4e45\u4ee5\u6765\uff0cNode.js \u5e94\u7528\u5f00\u53d1\u90fd\u5728\u4f7f\u7528 Inspector \u8c03\u8bd5\u4ee3\u7801\u6216\u5806\u5feb\u7167(Heap Snapshot) \u5b9a\u4f4d OOM \u95ee\u9898\uff0c\u8fd9\u4e9b\u672c\u5730\u5f00\u53d1\u7684\u5de5\u5177\u548c\u7279\u6027\u652f\u6491\u4e86\u5e9e\u5927\u7684\u5e94\u7528\u7684\u5f00\u53d1\u3002"),(0,a.kt)("p",null,"Serverless \u5e94\u7528\u901a\u5e38\u4f1a\u4f7f\u7528\u5927\u91cf\u751f\u547d\u5468\u671f\u77ed\u3001\u89c4\u683c\u5c0f\u7684\u5bb9\u5668\uff0c\u4f46\u5728\u6b64\u7c7b\u5bb9\u5668\u4e0a\u83b7\u5f97\u8c03\u8bd5\u8bca\u65ad\u80fd\u529b\u5e76\u4e0d\u5bb9\u6613\uff0c\u8fd9\u4f7f\u5f97 Serverless \u5e94\u7528\u957f\u671f\u5904\u4e8e\u8f83\u4e3a\u9ed1\u76d2\u7684\u5904\u5883\uff0c"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Inspector \u9700\u8981\u7a33\u5b9a\u548c\u5b9e\u65f6\u7684\u7f51\u7edc\u8fde\u63a5"),(0,a.kt)("li",{parentName:"ul"},"Heap Snapshot \u9700\u8981\u8f83\u591a\u7684\u8ba1\u7b97\u548c\u5185\u5b58\u8d44\u6e90")),(0,a.kt)("h3",{id:"\u57fa\u4e8e-corefile-\u7684-\u5feb\u7167"},'\u57fa\u4e8e Corefile \u7684 "\u5feb\u7167"'),(0,a.kt)("p",null,'\u4e0d\u7ba1\u662f V8 \u7684\u5bf9\u8c61\u8fd8\u662f\u5806\u5feb\u7167\uff0c\u5b83\u90fd\u662f "\u4fe1\u606f" \u5728\u5185\u5b58\u4e2d\u7684\u5b58\u50a8\uff0c\u800c Inspector \u529f\u80fd\u5c31\u662f\u53ef\u4ee5\u5728 "\u8fd0\u884c\u65f6" \u80fd\u63d0\u53d6\u8fd9\u4e9b\u4fe1\u606f\u3002',(0,a.kt)("br",{parentName:"p"}),"\n","Noslate Debugger \u901a\u8fc7 Corefile \u5c06\u8fd9\u90e8\u5206\u8c03\u8bd5\u8bca\u65ad\u80fd\u529b\u8f6c\u79fb\u5230\u4e86\u79bb\u7ebf\u65f6\u8fdb\u884c\uff0c\u8ba9\u539f\u6709\u5b9e\u65f6\u6027\u8981\u6c42\u9ad8\u7684\u5728\u7ebf\u8bca\u65ad\u8c03\u8bd5\u8f6c\u5316\u4e3a\u53ea\u9700\u7b80\u5355\u6587\u4ef6\u4e0a\u4f20\u5373\u53ef\u96c6\u6210\u4f7f\u7528\u3002"),(0,a.kt)("p",null,"\u5728\u7528\u6237\u672c\u5730\u6216\u4e91\u7aef\u670d\u52a1\u4e0a\u63d0\u4f9b\u63a5\u8fd1\u7528\u6237\u672c\u5730\u5f00\u53d1\u65f6\u7684\u8c03\u8bd5\u8bca\u65ad\u4f53\u611f\u3002"),(0,a.kt)("div",{style:{maxWidth:"700px"}},(0,a.kt)("p",null,(0,a.kt)("img",{alt:"\u79bb\u7ebf\u5206\u6790",src:r(6817).Z,width:"861",height:"519"}))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Corefile (\u7279\u6307 GNU Corefile \u683c\u5f0f) \u4e3b\u8981\u8bb0\u5f55\u7684\u662f Node.js \u8fdb\u7a0b\u7684\u5185\u5b58\u548c\u5bc4\u5b58\u5668\u8f6c\u50a8(CoreDump: \u5185\u5b58\u5230\u78c1\u76d8\u7684\u8fc7\u7a0b)\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","\u6240\u4ee5\u5b83\u4e5f\u662f\u8fdb\u7a0b\u5b8c\u6574\u201c\u4fe1\u606f\u201d\uff0c\u88ab\u7528\u4e8e Linux \u7cfb\u7edf\u5e94\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"Crash(\u6709\u635f)")," \u7684\u8c03\u8bd5\u8f7d\u4f53\uff0c\u4e5f\u53ef\u7528\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"GCore(\u65e0\u635f)")," \u4ea7\u751f\u8fdb\u7a0b\u5feb\u7167\u7528\u4e8e\u79bb\u7ebf\u5206\u6790\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","Node.js \u5982\u679c\u53d1\u751f OOM \u4e00\u822c\u4f1a\u4ea7\u751f ",(0,a.kt)("inlineCode",{parentName:"p"},"core.<pid>")," \u6587\u4ef6\uff0c\u56e0\u4e3a\u662f\u5185\u5b58\u526f\u672c\u8f83\u5927\u6240\u4ee5\u975e\u5e38\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\uff0c\u9891\u7e41\u7684 Crash \u5c31\u4f1a\u9020\u6210\u78c1\u76d8\u7a7a\u95f4\u7528\u5c3d\u3002")),(0,a.kt)("h3",{id:"\u66f4\u5c0f\u7684\u4e1a\u52a1\u5f71\u54cd"},"\u66f4\u5c0f\u7684\u4e1a\u52a1\u5f71\u54cd"),(0,a.kt)("p",null,'\u5bf9\u6bd4\u539f\u6709\u7ebf\u4e0a "\u5806\u5feb\u7167" \u5bf9\u4e1a\u52a1\u7684\u5f71\u54cd\u957f\u8fbe\u6570\u5206\u949f\uff0c\u5230\u53ea\u5f71\u54cd\u4e1a\u52a1 RT \u79d2\u7ea7(\u901a\u8fc7 ',(0,a.kt)("inlineCode",{parentName:"p"},"GCore"),")\uff0c\u751a\u81f3\u53ea\u6709\u51e0\u5341\u6beb\u79d2(\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"p"},"Arthur"),")\u3002"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Corefile"),' \u5feb\u7167\u4e5f\u4e0d\u4f1a\u6709\u4efb\u4f55\u8fd0\u884c\u65f6\u7684"\u6dfb\u6cb9\u52a0\u918b"\uff0c\u6240\u4ee5\u5b83\u4e5f\u9002\u5408\u90a3\u4e9b\u8fd8\u672a\u88abGC\u7684\u5bf9\u8c61\u5b9a\u4f4d\uff0c\u8b6c\u5982\u8bca\u65ad\u5df2\u7ecf\u7ed3\u675f\u4e86\u7684\u4e1a\u52a1\u5904\u7406\u7b49\u3002'),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("inlineCode",{parentName:"p"},"Arthur")," \u662f Noslate Debugger \u5f00\u53d1\u7684\u7528\u4e8e\u4f4e\u5f71\u54cd\u83b7\u53d6 ",(0,a.kt)("inlineCode",{parentName:"p"},"core\u6587\u4ef6")," \u7684\u5de5\u5177\uff0c\u91c7\u7528 fork \u51cf\u5c11\u8fdb\u7a0b\u6682\u505c\u65f6\u95f4\uff0cLZ4 \u538b\u7f29\u51cf\u5c11\u8f6c\u50a8\u4f53\u79ef\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","\u901a\u8fc7 fork \u5b50\u8fdb\u7a0b\u63d0\u53d6\u5185\u5b58\u5feb\u7167\u800c\u4e0d\u5f71\u54cd\u76ee\u6807\u4e1a\u52a1\u8fdb\u7a0b\u7684\u7ee7\u7eed\u8fd0\u884c\uff0c\u5c06\u4e1a\u52a1\u8fdb\u7a0b RT \u5f71\u54cd\u8fdb\u4e00\u6b65\u51cf\u5c11\u5230\u6beb\u79d2\u7ea7\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","\u901a\u5e38\u4e00\u4e2a ",(0,a.kt)("inlineCode",{parentName:"p"},"Core\u6587\u4ef6")," \u53ef\u4ee5\u88ab\u538b\u7f29\u4e3a\u539f\u5c3a\u5bf8\u7684 20% \u5de6\u53f3\uff0c\u89c6\u4fe1\u606f\u662f\u5426\u53ef\u538b\u7f29\uff0c\u6587\u672c\u7684\u538b\u7f29\u7387\u8f83\u5927\u3002")),(0,a.kt)("p",null,"\u5e26\u4e1a\u52a1\u6d41\u91cf\u7684\u7ebf\u4e0a\u73af\u5883\u6293\u53d6\uff0c\u4e1a\u52a1\u5f71\u54cd 31.106 \u6beb\u79d2\uff0cCorefile \u5927\u5c0f\u4e3a 338 MB (\u8fdb\u7a0b\u539f\u4f7f\u7528 1.44GB \u7269\u7406\u5185\u5b58)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$arthur -p 13481\narthur[14380] I: thread: 13482\narthur[14380] I: thread: 13483\narthur[14380] I: thread: 13484\narthur[14380] I: thread: 13485\narthur[14380] I: thread: 13486\narthur[14380] I: thread: 13487\narthur[14380] I: thread: 13497\narthur[14380] I: thread: 13498\narthur[14380] I: thread: 13499\narthur[14380] I: thread: 13500\narthur[14380] I: remote mmap at 0x7f1e596a33a0\narthur[14380] I: remote fork at 0x7f1e5966fed0\narthur[14380] I: mmap = 0x7f1e5a7ce000\narthur[14380] I: child_pid = 14381\narthur[14380] I: munmap = 0\narthur[14380] W: pread mem(0x7ffe597aa000) failed(5).\narthur[14380] W: pread mem(0xffffffffff600000) failed(22).\narthur[14380] I: waitpid = 14381\narthur[14380] I: Process 13481 paused 31.106 ms.\narthur[14380] I: Compressed 1437173002 bytes into 337922551 bytes ==> 23.51%\n")),(0,a.kt)("h2",{id:"\u8c03\u8bd5\u4fe1\u606f\u5e93"},"\u8c03\u8bd5\u4fe1\u606f\u5e93"),(0,a.kt)("p",null,"\u5bf9\u4e8e\u4f20\u7edf C++ \u7a0b\u5e8f\u6765\u8bf4\uff0c\u53ea\u6709\u7f16\u8bd1\u6210 Debug \u7248\u672c\u7684\u4e8c\u8fdb\u5236\u624d\u5177\u6709\u53ef\u8c03\u8bd5\u80fd\u529b\u67e5\u770b\u7ed3\u6784\u4f53\u4fe1\u606f\u7b49\uff0c\u539f\u56e0\u662f\u7f16\u8bd1\u5668\u5728\u7f16\u8bd1\u65f6\u6dfb\u52a0\u4e86 DebugInfo(\u8c03\u8bd5\u4fe1\u606f)\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","Debug \u5f88\u5927\uff0c",(0,a.kt)("inlineCode",{parentName:"p"},"node_g")," \u52a8\u8f84 1GB \u4ee5\u4e0a\uff0c\u6240\u4ee5\u901a\u5e38\u5b98\u65b9\u53d1\u5e03\u5747\u91c7\u7528\u7684\u662f Release \u53d1\u5e03\u3002",(0,a.kt)("br",{parentName:"p"}),"\n","Noslate Debugger \u5efa\u8bbe\u4e86\u4e00\u4e2a Node.js / Alinode/ Aworker \u7684 LTS \u7248\u672c\u7684\u8c03\u8bd5\u4fe1\u606f\u5e93\uff0c\n\u5c06\u989d\u5916\u7684\u8c03\u8bd5\u4fe1\u606f\u5c01\u88c5\u5728\u4e86 ",(0,a.kt)("inlineCode",{parentName:"p"},"node.typ")," \u6587\u4ef6\u5e76\u505a\u4e86\u5408\u5e76\u538b\u7f29\uff0c\u4f7f\u5f97\u6587\u4ef6\u4f53\u79ef\u5728 10MB \u5de6\u53f3\uff0c\n\u4e5f\u5305\u62ec\u90a3\u4e9b\u5df2\u7ecf\u53d1\u5e03\u7684\u5386\u53f2\u7248\u672c\u3002  "),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"andb")," \u4e5f\u662f\u57fa\u4e8e\u8be5\u8c03\u8bd5\u4fe1\u606f\u5e93\u63d0\u4f9b\u591a\u7248\u672c\u7684\u79bb\u7ebf\u8c03\u8bd5\u80fd\u529b\uff0c"))}s.isMDXComponent=!0},6817:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/andb-pic1-ce62da097b57718a9c5905fed9ed3d34.png"},8617:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/noslate-db-84c936ded353dcea2260f173b8213cff.png"}}]);