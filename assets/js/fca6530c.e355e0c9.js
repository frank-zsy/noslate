"use strict";(self.webpackChunknoslate_website=self.webpackChunknoslate_website||[]).push([[9190],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>u});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):_(_({},n),e)),t},d=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},s=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),s=p(t),u=a,f=s["".concat(l,".").concat(u)]||s[u]||c[u]||i;return t?r.createElement(f,_(_({ref:n},d),{},{components:t})):r.createElement(f,_({ref:n},d))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,_=new Array(i);_[0]=s;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,_[1]=o;for(var p=2;p<i;p++)_[p]=t[p];return r.createElement.apply(null,_)}return r.createElement.apply(null,t)}s.displayName="MDXCreateElement"},3141:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>_,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var r=t(7462),a=(t(7294),t(3905));const i={},_="\u8c03\u8bd5\u4fe1\u606f (Dwarf)",o={unversionedId:"debugger/dwf/intro",id:"debugger/dwf/intro",title:"\u8c03\u8bd5\u4fe1\u606f (Dwarf)",description:"\u5bf9\u8c61\u7684\u81ea\u52a8\u5e03\u5c40\u4fe1\u606f",source:"@site/docs/debugger/dwf/intro.md",sourceDirName:"debugger/dwf",slug:"/debugger/dwf/intro",permalink:"/docs/debugger/dwf/intro",draft:!1,editUrl:"https://github.com/noslate-project/noslate/tree/main/site/docs/debugger/dwf/intro.md",tags:[],version:"current",frontMatter:{},sidebar:"debugger",previous:{title:"Arthur",permalink:"/docs/debugger/arthur/intro"},next:{title:"BuildID",permalink:"/docs/debugger/dwf/buildid"}},l={},p=[{value:"\u5bf9\u8c61\u7684\u81ea\u52a8\u5e03\u5c40\u4fe1\u606f",id:"\u5bf9\u8c61\u7684\u81ea\u52a8\u5e03\u5c40\u4fe1\u606f",level:2},{value:"\u6e90\u4ee3\u7801\u5230\u5bf9\u8c61\u663e\u793a",id:"\u6e90\u4ee3\u7801\u5230\u5bf9\u8c61\u663e\u793a",level:2},{value:"\u5408\u5e76\u5197\u4f59\u8282\u70b9",id:"\u5408\u5e76\u5197\u4f59\u8282\u70b9",level:2},{value:"\u8c03\u8bd5\u4fe1\u606f\u5e93",id:"\u8c03\u8bd5\u4fe1\u606f\u5e93",level:2}],d={toc:p};function c(e){let{components:n,...i}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,i,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u8c03\u8bd5\u4fe1\u606f-dwarf"},"\u8c03\u8bd5\u4fe1\u606f (Dwarf)"),(0,a.kt)("h2",{id:"\u5bf9\u8c61\u7684\u81ea\u52a8\u5e03\u5c40\u4fe1\u606f"},"\u5bf9\u8c61\u7684\u81ea\u52a8\u5e03\u5c40\u4fe1\u606f"),(0,a.kt)("p",null,"Node \u4f7f\u7528\u4e0d\u540c\u7684 V8 \u7248\u672c\uff0c\u8fd9\u4e9b\u7248\u672c\u5728\u5bf9\u8c61\u652f\u6301\u4e0a\u90fd\u6709\u5dee\u5f02\u3002\n\u90e8\u5206\u5bf9\u8c61\u8fd8\u91c7\u7528 Torque \u81ea\u52a8\u751f\u6210\uff0c\u4f46\u662f\u6700\u7ec8\u8fd8\u662f\u9700\u8981\u4ea7\u51fa\u6210 C++ \u7684\u6e90\u4ee3\u7801\uff0c\u5e76\u7f16\u8bd1\u5230 node \u4e8c\u8fdb\u5236\u4e2d\u3002"),(0,a.kt)("p",null,"Noslate Debugger \u4ece\u7f16\u8bd1\u5668\u4ea7\u51fa\u7684 DebugInfo(\u8c03\u8bd5\u4fe1\u606f) \u4e2d\u83b7\u53d6\u5230\u5bf9\u8c61\u7684 Layout \u4fe1\u606f\uff0c\u5e76\u81ea\u52a8\u4ea7\u751f\u5bf9\u5e94\u7684\u5bf9\u8c61\u7684\u89e3\u6790\u51fd\u6570\u3001DebugPrint\u7b49\u5b9e\u73b0\u3002"),(0,a.kt)("div",{style:{maxWidth:"800px"}},(0,a.kt)("p",null,(0,a.kt)("img",{alt:"CU Merge",src:t(574).Z,width:"744",height:"235"}))),(0,a.kt)("h2",{id:"\u6e90\u4ee3\u7801\u5230\u5bf9\u8c61\u663e\u793a"},"\u6e90\u4ee3\u7801\u5230\u5bf9\u8c61\u663e\u793a"),(0,a.kt)("p",null,"DebugInfo \u4e2d\u4fdd\u5b58\u4e86 c++ \u7c7b\u3001\u7ed3\u6784\u4f53\u3001\u679a\u4e3e\u503c\u7b49\u8bf8\u591a\u8c03\u8bd5\u4fe1\u606f\uff0c\u8fd9\u4e9b\u8c03\u8bd5\u4fe1\u606f\u88ab ",(0,a.kt)("inlineCode",{parentName:"p"},"gdb"),"/",(0,a.kt)("inlineCode",{parentName:"p"},"lldb")," \u7b49\u8c03\u8bd5\u5668\u7528\u4e8e\u89e3\u6790\u5185\u5b58\u533a\u5757\uff0c\u89e3\u6790\u51fa\u7c7b\u3001\u7ed3\u6784\u4f53\u7b49\u7528\u6237\u6613\u8bfb\u7684\u5185\u5bb9\u3002\n\u8981\u663e\u793a\u4efb\u610f Node.js / V8 \u5f15\u64ce\u6240\u4f7f\u7528\u7684 c++ \u7ed3\u6784\u4f53\u5bf9\u8c61\uff0c\u9700\u8981\u4ece\u8c03\u8bd5\u4fe1\u606f\u4e2d\u627e\u5230\u5bf9\u5e94\u7684\u7ed3\u6784\u4f53\u5b50\u6811\uff0c\u5176\u5b50\u6811\u53f6\u5b50\u63cf\u8ff0\u4e86\u8fd9\u4e2a\u7ed3\u6784\u4f53\u7684\u6240\u6709 member \u6240\u5728\u5185\u5b58\u7684\u504f\u79fb\u5730\u5740\uff0c\u7c7b\u578b\uff0c\u5927\u5c0f\u7b49\u8be6\u7ec6\u4fe1\u606f\u3002V8 \u4f7f\u7528\u7684\u591a\u6570\u5bf9\u8c61\u90fd\u7ee7\u627f\u81ea ",(0,a.kt)("inlineCode",{parentName:"p"},"v8::internal::HeapObject"),"\uff0c\u5b83\u662f\u4e00\u4e2a\u7cfb\u7edf Pointer \u5b57\u5bbd\u5927\u5c0f\u7684 C++ \u7c7b\u5b9a\u4e49\uff0c\u4f46\u4e0d\u540c\u7684\u5bf9\u8c61\u6709\u4e0d\u540c\u7684 Layout\uff0c\u5176\u4fe1\u606f\u5219\u7531\u8be5\u5b50\u6811\u4e0a\u6240\u5bf9\u5e94\u7684\u679a\u4e3e\u503c\u6240\u5b9a\u4e49\u3002\u8b6c\u5982 ",(0,a.kt)("inlineCode",{parentName:"p"},"Oddbal")," \u5bf9\u8c61\u4e2d\uff0c\u5b83\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"ToString")," \u63cf\u8ff0\u4f1a\u7531 ",(0,a.kt)("inlineCode",{parentName:"p"},"kToStringOffset = 16")," \u63cf\u8ff0\uff0c\u8fd9\u4e2a\u503c\u5728\u4e0d\u540c\u7684 V8 \u5b9e\u73b0\u4e2d\u53ef\u80fd\u4e0d\u540c\uff0c\u4f46\u662f\u4ece DebugInfo \u4e2d\u53ef\u4ee5\u83b7\u53d6\u6b63\u786e\u7684\u503c\u3002"),(0,a.kt)("p",null,"Noslate Debugger \u6b63\u662f\u5229\u7528\u4e86\u8fd9\u4e9b\u7ed3\u6784\u4f53\u4fe1\u606f\uff0c\u7f16\u5199\u4e86 Shadow \u5f15\u64ce\u7528\u4e8e\u89e3\u6790 V8 \u5bf9\u8c61\u548c\u6267\u884c Corefile \u91cc\u7684\u5206\u6790\u65f6\u903b\u8f91\u3002"),(0,a.kt)("div",{style:{maxWidth:"600px"}},(0,a.kt)("p",null,(0,a.kt)("img",{alt:"CU Merge",src:t(3079).Z,width:"560",height:"403"}))),(0,a.kt)("h2",{id:"\u5408\u5e76\u5197\u4f59\u8282\u70b9"},"\u5408\u5e76\u5197\u4f59\u8282\u70b9"),(0,a.kt)("p",null,"\u4e00\u4e2a\u5b8c\u5168\u6784\u5efa\u7684 Node.js Debug \u7248\u672c\uff0c\u53ef\u8fbe 2.4 GB\uff0c\u5176\u4e2d\u5305\u542b 23577 \u4e07 DIE\uff0c76883 \u4e07\u5c5e\u6027\uff0c\u8fd9\u6837\u7684\u6587\u4ef6\u5927\u5c0f\u65e0\u6cd5\u8fdb\u884c\u5206\u53d1\u3002"),(0,a.kt)("p",null,"Noslate Debugger \u5c06\u5197\u4f59\u7684\u8c03\u8bd5\u4fe1\u606f\u8282\u70b9\u8fdb\u884c\u4e86 CU \u5408\u5e76\u3002\u5408\u5e76\u540e\uff0cnode.typ \u6587\u4ef6\u4ec5\u6709 150MB\uff0c\u5305\u542b\u5168\u91cf 189 \u4e07 DIE\uff0c546 \u4e07\u5c5e\u6027\u3002"),(0,a.kt)("div",null,(0,a.kt)("p",null,(0,a.kt)("img",{alt:"CU Merge",src:t(315).Z,width:"2340",height:"1603"}))),(0,a.kt)("p",null,"\u5176\u4e2d\u4e5f\u5305\u62ec\u4e86\u5927\u91cf\u7cfb\u7edf\u5934\u6587\u4ef6\u3001\u4f9d\u8d56\u5934\u6587\u4ef6\u91cc\u5b9a\u4e49\u7684\u8c03\u8bd5\u4fe1\u606f\uff0c\u6240\u4ee5\u76ee\u524d\u7ebf\u4e0a\u8c03\u8bd5\u4fe1\u606f\u5e93\u6240\u4f7f\u7528\u7684 node.typ \u7248\u672c\uff0c\u662f\u8fdb\u4e00\u6b65\u7cbe\u7b80\u7684\u7248\u672c\uff0c\u5728 10MB \u5de6\u53f3\u66f4\u52a0\u5229\u4e8e\u5206\u53d1\uff0c\n\u5176\u5305\u542b 44 \u4e07 DIE\uff0c137 \u4e07\u5c5e\u6027\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ls -al node.typ\n-rw------- 1 zlei users 13119741 Sep 27 11:00 node.typ\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$dwf -i node.typ\nsection .debug_abbrev, addr(0x7f17b5b653be), size(8219)\nsection .debug_info, addr(0x7f17b5b673d9), size(4404799)\nsection .debug_line, addr(0x7f17b67dd850), size(43181)\nsection .debug_str, addr(0x7f17b5f9aa18), size(8662584)\ndwf>sum .\n------ TAG (448021) -----\n  DW_TAG_unspecified_type : 1\n  DW_TAG_compile_unit : 1\n  DW_TAG_volatile_type : 12\n  DW_TAG_ptr_to_member_type : 12\n  DW_TAG_base_type : 20\n  DW_TAG_lexical_block : 85\n  DW_TAG_subroutine_type : 92\n  DW_TAG_namespace : 244\n  DW_TAG_array_type : 318\n  DW_TAG_union_type : 533\n  DW_TAG_GNU_template_template_param : 661\n  DW_TAG_rvalue_reference_type : 973\n  DW_TAG_enumeration_type : 2148\n  DW_TAG_variable : 3058\n  DW_TAG_GNU_template_parameter_pack : 3657\n  DW_TAG_formal_parameter : 4972\n  DW_TAG_subprogram : 7666\n  DW_TAG_imported_declaration : 7862\n  DW_TAG_pointer_type : 8012\n  DW_TAG_reference_type : 9668\n  DW_TAG_template_value_param : 12076\n  DW_TAG_const_type : 19645\n  DW_TAG_inheritance : 21288\n  DW_TAG_enumerator : 21788\n  DW_TAG_class_type : 22090\n  DW_TAG_structure_type : 38440\n  DW_TAG_member : 54438\n  DW_TAG_padding : 65946\n  DW_TAG_template_type_param : 70986\n  DW_TAG_typedef : 71329\n------ Attributes (1371821) -----\n  DW_AT_producer : 1\n  DW_AT_GNU_vector : 1\n  DW_AT_comp_dir : 1\n  DW_AT_language : 1\n  DW_AT_high_pc : 1\n  DW_AT_stmt_list : 1\n  DW_AT_low_pc : 1\n  DW_AT_location : 4\n  DW_AT_export_symbols : 5\n  DW_AT_use_location : 8\n  DW_AT_object_pointer : 16\n  DW_AT_prototyped : 33\n  DW_AT_specification : 41\n  DW_AT_bit_size : 123\n  DW_AT_bit_offset : 123\n  DW_AT_enum_class : 401\n  DW_AT_GNU_template_name : 661\n  DW_AT_const_expr : 1439\n  DW_AT_default_value : 1924\n  DW_AT_encoding : 2168\n  DW_AT_containing_type : 3265\n  DW_AT_alignment : 4243\n  DW_AT_artificial : 5263\n  DW_AT_linkage_name : 7004\n  DW_AT_import : 7862\n  DW_AT_external : 11680\n  DW_AT_declaration : 19833\n  DW_AT_const_value : 44726\n  DW_AT_sibling : 61297\n  DW_AT_accessibility : 61776\n  DW_AT_data_member_location : 62473\n  DW_AT_byte_size : 76952\n  DW_AT_decl_column : 140774\n  DW_AT_decl_line : 140778\n  DW_AT_decl_file : 140778\n  DW_AT_type : 278262\n  DW_AT_name : 297902\ndwf>\n")),(0,a.kt)("h2",{id:"\u8c03\u8bd5\u4fe1\u606f\u5e93"},"\u8c03\u8bd5\u4fe1\u606f\u5e93"),(0,a.kt)("p",null,"Noslate Debugger \u7684 CI \u4f1a\u81ea\u52a8\u8ddf\u8e2a Node.js\u3001Alinode\u3001Aworker \u7684\u5b98\u65b9\u53d1\u5e03\uff0c\u5e76\u81ea\u52a8\u6784\u5efa\u76f8\u5e94\u7684\u8c03\u8bd5\u4fe1\u606f ",(0,a.kt)("inlineCode",{parentName:"p"},"node.typ")," \u6587\u4ef6\u3002\n\u8fd9\u4e2a\u591a\u7248\u672c\u4ed3\u5e93\u5df2\u7ecf\u7f16\u5165 ",(0,a.kt)("inlineCode",{parentName:"p"},"andb")," \u5de5\u5177\u4e2d\uff0c\u5728\u8c03\u8bd5 Corefile \u65f6\u4f1a\u81ea\u52a8\u5339\u914d\u548c\u4e0b\u8f7d\u3002"))}c.isMDXComponent=!0},315:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/dwf-die-e8fdb9a77453821dadef719b737016dc.png"},574:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/dwf-layout-95a04cd4f358aff854b509126894e52c.png"},3079:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/dwf-pic1-dfd8c080df8e53c0b0792cf365f3cb5a.png"}}]);